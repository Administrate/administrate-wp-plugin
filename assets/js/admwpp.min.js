!function(e){e.ADMShortcode=function(){var t=this;t.call=0;var a=e.ADMShortcode.defaults;e(a.giftVoucherFormAmountValidate).length>0&&e(a.giftVoucherFormAmountValidate).on("change keyup",function(a){var r=e(this);t.isValidGiftVoucherInput(r)}),e(a.giftVoucherFormBtn).length>0&&e(a.giftVoucherFormBtn).on("click",function(a){a.preventDefault();var r=e(this);t.addGiftVoucher(r)})},e.ADMShortcode.prototype={isValidGiftVoucherInput:function(t){var a=e.ADMShortcode.defaults,r=t.parents(a.giftVoucherForm),o=e(a.giftVoucherFormBtn,r),d=e(a.giftVoucherMessage,r).html(""),i=t.val();return o.prop("disabled",!1),e.isNumeric(i)?i<=0?(d.html(admwpp.giftVoucher.error.emptyAmount).addClass("admwpp-error"),o.prop("disabled",!0),!1):!(i>admwpp.giftVoucher.maxAmount)||(d.html(admwpp.giftVoucher.error.maxAmount).addClass("admwpp-error"),o.prop("disabled",!0),!1):(d.html(admwpp.giftVoucher.error.notNumber).addClass("admwpp-error"),o.prop("disabled",!0),!1)},addGiftVoucher:function(t){var a=e.ADMShortcode.defaults,r=t.parents(a.giftVoucherForm),o=e(a.giftVoucherMessage,r).html("").removeClass("admwpp-error").removeClass("admwpp-success");if(!r.hasClass("admwpp-loading")){r.addClass("admwpp-loading"),t.prop("disabled",!0);var d=e("input[name='"+a.giftVoucherFormAmount+"']",r);if(this.isValidGiftVoucherInput(d)){var i={action:"addGiftVoucher",amount:d.val(),productOptionId:t.data("options_id"),cartId:"",portalToken:""};null!=weblink?(i.cartId=localStorage.getItem("weblink:"+webLinkConfig.portalAddress+":cartId"),i.portalToken=localStorage.getItem("weblink:"+webLinkConfig.portalAddress+":portalToken"),i.portal=webLinkConfig.portalAddress,e.ajax({type:"post",url:admwpp.ajaxUrl,data:i,dataType:"json",success:function(a){o.html(a.message),"success"===a.status?(o.addClass("admwpp-success"),null!=weblink&&a.cartId&&(weblink.cartId=a.cartId,localStorage.setItem("weblink:"+webLinkConfig.portalAddress+":cartId",a.cartId)),e(".weblink-Basket").length>0&&location.reload()):o.addClass("admwpp-error"),d.val(""),r.removeClass("admwpp-loading"),t.prop("disabled",!1)}})):o.html(admwpp.giftVoucher.error.weblink).addClass("admwpp-error")}else t.prop("disabled",!1)}}},e.ADMShortcode.defaults={giftVoucherForm:".admwpp-add-gift-voucher-form",giftVoucherFormBtn:".admwpp-add-gift-voucher-btn",giftVoucherFormAmount:"admwpp-gift-voucher-amount",giftVoucherFormAmountValidate:".admwpp-gift-voucher-amount-validate",giftVoucherMessage:".admwpp-message"}}(jQuery),function(e){e(document).ready(function(){new e.ADMShortcode;jQuery().selectric&&e(".admwpp-custom-select").selectric();var t=admwpp.search.dateFormat,a=e(".admwpp-from-date").datepicker({defaultDate:"+1w",changeMonth:!0,numberOfMonths:1}).on("change",function(){r.datepicker("option","minDate",o(this))}),r=e(".admwpp-to-date").datepicker({defaultDate:"+1w",changeMonth:!0,numberOfMonths:1}).on("change",function(){a.datepicker("option","maxDate",o(this))});function o(a){var r;try{r=e.datepicker.parseDate(t,a.value)}catch(e){r=null}return r}})}(jQuery);