!function(e){e.ADMShortcode=function(){var t=this;t.call=0;var a=e.ADMShortcode.defaults;e(a.giftVoucherFormBtn).length>0&&e(a.giftVoucherFormBtn).on("click",function(a){a.preventDefault();var o=e(this);t.addGiftVoucher(o)})},e.ADMShortcode.prototype={addGiftVoucher:function(t){var a=e.ADMShortcode.defaults,o=t.parents(a.giftVoucherForm),r=e(a.giftVoucherMessage,o).html("").removeClass("admwpp-error").removeClass("admwpp-success");if(!o.hasClass("admwpp-loading")){o.addClass("admwpp-loading"),t.prop("disabled",!0);var d=e("input[name='"+a.giftVoucherFormAmount+"']",o);if(d.val()<=0)return r.html(admwpp.giftVoucher.error.emptyAmount).addClass("admwpp-error"),o.removeClass("admwpp-loading"),void t.prop("disabled",!1);var n={action:"addGiftVoucher",amount:d.val(),productOptionId:t.data("options_id"),cartId:"",portalToken:""};null!=weblink?(n.cartId=localStorage.getItem("weblink:"+webLinkConfig.portalAddress+":cartId"),n.portalToken=localStorage.getItem("weblink:"+webLinkConfig.portalAddress+":portalToken"),n.portal=webLinkConfig.portalAddress,e.ajax({type:"post",url:admwpp.ajaxUrl,data:n,dataType:"json",success:function(a){r.html(a.message),"success"===a.status?(r.addClass("admwpp-success"),null!=weblink&&a.cartId&&(weblink.cartId=a.cartId,localStorage.setItem("weblink:"+webLinkConfig.portalAddress+":cartId",a.cartId)),e(".weblink-Basket").length>0&&null!=weblink&&e(".weblink-Basket").each(function(){var t=e(this).attr("id"),o=document.getElementById(t);window.WebLink.unmount(o),weblink.mount(o,"Basket",{showBasketPopover:!0,cartUrl:a.cartUrl})})):r.addClass("admwpp-error"),d.val(""),o.removeClass("admwpp-loading"),t.prop("disabled",!1)}})):r.html(admwpp.giftVoucher.error.weblink).addClass("admwpp-error")}}},e.ADMShortcode.defaults={giftVoucherForm:".admwpp-add-gift-voucher-form",giftVoucherFormBtn:".admwpp-add-gift-voucher-btn",giftVoucherFormAmount:"admwpp-gift-voucher-amount",giftVoucherMessage:".admwpp-message"}}(jQuery),function(e){e(document).ready(function(){new e.ADMShortcode;jQuery().selectric&&e(".admwpp-custom-select").selectric();var t=admwpp.search.dateFormat,a=e(".admwpp-from-date").datepicker({defaultDate:"+1w",changeMonth:!0,numberOfMonths:1}).on("change",function(){o.datepicker("option","minDate",r(this))}),o=e(".admwpp-to-date").datepicker({defaultDate:"+1w",changeMonth:!0,numberOfMonths:1}).on("change",function(){a.datepicker("option","maxDate",r(this))});function r(a){var o;try{o=e.datepicker.parseDate(t,a.value)}catch(e){o=null}return o}})}(jQuery);