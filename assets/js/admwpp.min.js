!function(t){t.ADMShortcode=function(){var e=this;e.call=0;var a=t.ADMShortcode.defaults;t(a.giftVoucherFormAmountValidate).length>0&&t(a.giftVoucherFormAmountValidate).on("change keyup",function(a){var r=t(this);e.isValidGiftVoucherInput(r)}),t(a.giftVoucherFormBtn).length>0&&t(a.giftVoucherFormBtn).on("click",function(a){a.preventDefault();var r=t(this);e.addGiftVoucher(r)})},t.ADMShortcode.prototype={isValidGiftVoucherInput:function(e){var a=t.ADMShortcode.defaults,r=e.parents(a.giftVoucherForm),o=t(a.giftVoucherFormBtn,r),d=t(a.giftVoucherMessage,r).html(""),n=e.val();return o.prop("disabled",!0),t.isNumeric(n)?n<=0?(d.html(admwpp.giftVoucher.error.emptyAmount).addClass("admwpp-error"),!1):n>admwpp.giftVoucher.maxAmount?(d.html(admwpp.giftVoucher.error.maxAmount).addClass("admwpp-error"),!1):(o.prop("disabled",!1),!0):(d.html(admwpp.giftVoucher.error.notNumber).addClass("admwpp-error"),!1)},addGiftVoucher:function(e){var a=t.ADMShortcode.defaults,r=e.parents(a.giftVoucherForm),o=t(a.giftVoucherMessage,r).html("").removeClass("admwpp-error").removeClass("admwpp-success");if(!r.hasClass("admwpp-loading")){var d=t("input[name='"+a.giftVoucherFormAmount+"']",r);if(this.isValidGiftVoucherInput(d)){r.addClass("admwpp-loading"),e.prop("disabled",!0);var n={action:"addGiftVoucher",amount:d.val(),productOptionId:e.data("options_id"),cartId:"",portalToken:""};null!=weblink?(n.cartId=localStorage.getItem("weblink:"+webLinkConfig.portalAddress+":cartId"),n.portalToken=localStorage.getItem("weblink:"+webLinkConfig.portalAddress+":portalToken"),n.portal=webLinkConfig.portalAddress,t.ajax({type:"post",url:admwpp.ajaxUrl,data:n,dataType:"json",success:function(a){o.html(a.message),"success"===a.status?(o.addClass("admwpp-success"),null!=weblink&&a.cartId&&(weblink.cartId=a.cartId,localStorage.setItem("weblink:"+webLinkConfig.portalAddress+":cartId",a.cartId)),t(".weblink-Basket").length>0&&location.reload()):o.addClass("admwpp-error"),d.val(""),r.removeClass("admwpp-loading"),e.prop("disabled",!0)}})):o.html(admwpp.giftVoucher.error.weblink).addClass("admwpp-error")}}}},t.ADMShortcode.defaults={giftVoucherForm:".admwpp-add-gift-voucher-form",giftVoucherFormBtn:".admwpp-add-gift-voucher-btn",giftVoucherFormAmount:"admwpp-gift-voucher-amount",giftVoucherFormAmountValidate:".admwpp-gift-voucher-amount-validate",giftVoucherMessage:".admwpp-message"}}(jQuery),function(t){t(document).ready(function(){new t.ADMShortcode;jQuery().selectric&&t(".admwpp-custom-select").selectric();var e=admwpp.search.dateFormat,a=t(".admwpp-from-date").datepicker({defaultDate:"+1w",changeMonth:!0,numberOfMonths:1}).on("change",function(){r.datepicker("option","minDate",o(this))}),r=t(".admwpp-to-date").datepicker({defaultDate:"+1w",changeMonth:!0,numberOfMonths:1}).on("change",function(){a.datepicker("option","maxDate",o(this))});function o(a){var r;try{r=t.datepicker.parseDate(e,a.value)}catch(t){r=null}return r}})}(jQuery);